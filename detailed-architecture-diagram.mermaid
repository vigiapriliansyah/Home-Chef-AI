graph TB
    %% ========================================
    %% PROJECT 1: HOME CHEF AI WEB APPLICATION - DETAILED
    %% ========================================
    
    subgraph "ğŸŒ HOME CHEF AI WEB APPLICATION (Next.js 15 + TypeScript)"
        direction TB
        
        %% Frontend Components
        subgraph "ğŸ“± Frontend Components & Pages"
            HOME["ğŸ  Landing Page<br/>â€¢ src/app/page.tsx<br/>â€¢ Welcome interface<br/>â€¢ Login/Register prompts<br/>â€¢ Logo & branding"]
            CHAT["ğŸ’¬ Chat Interface<br/>â€¢ src/app/chat/[id]/page.tsx<br/>â€¢ Message bubbles<br/>â€¢ Streaming responses<br/>â€¢ Real-time updates"]
            AUTH_PAGES["ğŸ” Auth Pages<br/>â€¢ src/app/auth/signin<br/>â€¢ src/app/auth/register<br/>â€¢ Login forms<br/>â€¢ OAuth buttons"]
            SHARED["ğŸ”— Shared Chat<br/>â€¢ src/app/shared/[shareId]<br/>â€¢ Public chat view<br/>â€¢ Read-only interface"]
            ERRORS["âŒ Error Pages<br/>â€¢ src/app/error.tsx<br/>â€¢ src/app/not-found.tsx<br/>â€¢ 404 handling<br/>â€¢ Error boundaries"]
        end
        
        subgraph "ğŸ¨ UI Component Library"
            SHADCN["ğŸ§© Shadcn/UI Components<br/>â€¢ components/ui/<br/>â€¢ Button, Input, Dialog<br/>â€¢ Chat bubbles<br/>â€¢ Dropdown menus"]
            CUSTOM["ğŸ› ï¸ Custom Components<br/>â€¢ SiteHeader<br/>â€¢ UserDropdown<br/>â€¢ ShareDrawer<br/>â€¢ LoginDialog"]
            SIDEBAR["ğŸ“‹ Sidebar Components<br/>â€¢ AppSidebar<br/>â€¢ SettingSidebar<br/>â€¢ Chat history<br/>â€¢ Theme switcher"]
        end
        
        %% Business Logic
        subgraph "ğŸ§  Business Logic & State Management"
            NEXTAUTH["ğŸ” NextAuth.js Configuration<br/>â€¢ src/lib/auth.ts<br/>â€¢ Google OAuth provider<br/>â€¢ Credentials provider<br/>â€¢ Session management"]
            HOOKS["ğŸª Custom React Hooks<br/>â€¢ src/hooks/<br/>â€¢ useChat<br/>â€¢ useSession<br/>â€¢ useLocalStorage"]
            UTILS["ğŸ› ï¸ Utility Functions<br/>â€¢ src/lib/utils.ts<br/>â€¢ fetchEventSource<br/>â€¢ processChunk<br/>â€¢ cn (class names)"]
            THEME["ğŸ¨ Theme Management<br/>â€¢ ThemeProvider<br/>â€¢ Dark/Light mode<br/>â€¢ CSS variables<br/>â€¢ Tailwind classes"]
        end
        
        %% API Layer Details
        subgraph "ğŸ”Œ API Routes & Middleware"
            API_AUTH["ğŸ” Auth API Routes<br/>â€¢ /api/auth/[...nextauth]<br/>â€¢ /api/auth/register<br/>â€¢ Session handling<br/>â€¢ User creation"]
            API_CHAT["ğŸ’¬ Chat API Routes<br/>â€¢ /api/chat (GET, POST)<br/>â€¢ /api/chat/[id] (GET, PUT, DELETE)<br/>â€¢ /api/chat/[id]/messages<br/>â€¢ /api/chat/[id]/share"]
            MIDDLEWARE["âš™ï¸ Middleware<br/>â€¢ src/middleware.ts<br/>â€¢ Route protection<br/>â€¢ Auth validation<br/>â€¢ Redirect logic"]
            VALIDATION["âœ… Request Validation<br/>â€¢ Zod schemas<br/>â€¢ Input sanitization<br/>â€¢ Error handling"]
        end
        
        %% Database Layer
        subgraph "ğŸ’¾ Database Schema & ORM"
            PRISMA_SCHEMA["ğŸ“‹ Prisma Schema<br/>â€¢ prisma/schema.prisma<br/>â€¢ User model<br/>â€¢ Channel model<br/>â€¢ Message model<br/>â€¢ Account/Session models"]
            DB_OPERATIONS["ğŸ”§ Database Operations<br/>â€¢ CRUD operations<br/>â€¢ Relationship queries<br/>â€¢ Transaction handling<br/>â€¢ Migration management"]
            SQLITE["ğŸ—„ï¸ SQLite Database<br/>â€¢ dev.db file<br/>â€¢ Users table<br/>â€¢ Channels table<br/>â€¢ Messages table<br/>â€¢ NextAuth tables"]
        end
        
        %% Configuration
        subgraph "âš™ï¸ Configuration & Build"
            NEXTCONFIG["ğŸ“ Next.js Config<br/>â€¢ next.config.ts<br/>â€¢ Image domains<br/>â€¢ ESLint ignore<br/>â€¢ TypeScript config"]
            TAILWIND["ğŸ¨ Tailwind Config<br/>â€¢ postcss.config.mjs<br/>â€¢ CSS utilities<br/>â€¢ Custom themes<br/>â€¢ Component styles"]
            PACKAGE["ğŸ“¦ Dependencies<br/>â€¢ package.json<br/>â€¢ Next.js 15<br/>â€¢ React 19<br/>â€¢ Prisma<br/>â€¢ NextAuth"]
        end
    end
    
    %% ========================================
    %% PROJECT 2: AI TRAINING PIPELINE - DETAILED
    %% ========================================
    
    subgraph "ğŸ¤– AI MODEL TRAINING PIPELINE (PyTorch + Transformers)"
        direction TB
        
        %% Data Management
        subgraph "ğŸ“Š Dataset Processing & Management"
            RAW_DATA["ğŸ“ Raw Dataset<br/>â€¢ Indonesian_Food_Recipes_full.csv<br/>â€¢ 1000+ recipes<br/>â€¢ Title, Ingredients, Steps<br/>â€¢ Indonesian cuisine focus"]
            DATA_CLEANING["ğŸ§¹ Data Cleaning<br/>â€¢ clean_ingredients()<br/>â€¢ Remove measurements<br/>â€¢ Extract ingredient names<br/>â€¢ Language normalization"]
            EXAMPLE_GEN["ğŸ”„ Training Example Generation<br/>â€¢ generate_training_examples()<br/>â€¢ 4 types per recipe:<br/>  - Standard recipe request<br/>  - Simple questions<br/>  - Ingredient-based recommendations<br/>  - Ingredient inquiry"]
            TOKENIZATION["ğŸ”¤ Text Tokenization<br/>â€¢ AutoTokenizer.from_pretrained()<br/>â€¢ Chat template application<br/>â€¢ Padding & truncation<br/>â€¢ Max length: 512 tokens"]
        end
        
        %% Model Configuration
        subgraph "âš™ï¸ Model Configuration & Setup"
            BASE_MODEL_CONFIG["ğŸ—ï¸ Base Model Loading<br/>â€¢ Model: Qwen/Qwen2-0.5B-Instruct<br/>â€¢ AutoModelForCausalLM<br/>â€¢ torch_dtype: auto<br/>â€¢ device_map: auto"]
            LORA_CONFIG["ğŸ”— LoRA Configuration<br/>â€¢ r=16, lora_alpha=32<br/>â€¢ target_modules: q_proj, v_proj, k_proj<br/>â€¢ lora_dropout=0.05<br/>â€¢ TaskType.CAUSAL_LM"]
            TRAINING_ARGS["ğŸ“‹ Training Arguments<br/>â€¢ epochs=3, batch_size=2<br/>â€¢ learning_rate=2e-5<br/>â€¢ gradient_accumulation_steps=4<br/>â€¢ fp16=True, warmup_steps=100"]
            SYSTEM_PROMPT["ğŸ“ System Prompt<br/>â€¢ Indonesian Chef persona<br/>â€¢ Traditional cuisine expert<br/>â€¢ Recipe instruction specialist<br/>â€¢ Ingredient recommendation"]
        end
        
        %% Training Process
        subgraph "ğŸƒâ€â™‚ï¸ Training Execution & Monitoring"
            DATA_COLLATOR["ğŸ“¦ Data Collation<br/>â€¢ DataCollatorForLanguageModeling<br/>â€¢ mlm=False (causal LM)<br/>â€¢ Dynamic padding<br/>â€¢ Token alignment"]
            TRAINER_EXEC["ğŸ”¥ Training Execution<br/>â€¢ Hugging Face Trainer<br/>â€¢ LoRA parameter updates<br/>â€¢ Gradient checkpointing<br/>â€¢ Loss calculation & backprop"]
            MONITORING["ğŸ“Š Training Monitoring<br/>â€¢ Logging steps: 100<br/>â€¢ Save steps: 500<br/>â€¢ Loss tracking<br/>â€¢ Performance metrics"]
            CHECKPOINTS["ğŸ’¾ Model Checkpoints<br/>â€¢ ./IFMF-Qwen2-0.5B-Instruct-full<br/>â€¢ Adapter weights<br/>â€¢ Training state<br/>â€¢ Metadata storage"]
        end
        
        %% Output Management
        subgraph "ğŸ“¤ Output & Deployment Preparation"
            MODEL_SAVING["ğŸ’¾ Model Serialization<br/>â€¢ trainer.save_model()<br/>â€¢ tokenizer.save_pretrained()<br/>â€¢ Config file generation<br/>â€¢ Adapter weight storage"]
            METADATA_GEN["ğŸ“‹ Metadata Generation<br/>â€¢ training_metadata.json<br/>â€¢ Recipe count<br/>â€¢ Training examples count<br/>â€¢ Model capabilities<br/>â€¢ Performance stats"]
            MODEL_VALIDATION["âœ… Model Validation<br/>â€¢ Generation testing<br/>â€¢ Response quality check<br/>â€¢ Indonesian language validation<br/>â€¢ Recipe accuracy verification"]
        end
    end
    
    %% ========================================
    %% PROJECT 3: AI API SERVER - DETAILED
    %% ========================================
    
    subgraph "ğŸš€ AI API SERVER (FastAPI + PyTorch Inference)"
        direction TB
        
        %% Server Framework
        subgraph "ğŸŒ FastAPI Server Setup"
            FASTAPI_APP["âš¡ FastAPI Application<br/>â€¢ app = FastAPI()<br/>â€¢ CORS middleware<br/>â€¢ Request/Response models<br/>â€¢ Error handling"]
            CORS_CONFIG["ğŸ”„ CORS Configuration<br/>â€¢ allow_origins: ['*']<br/>â€¢ allow_credentials: True<br/>â€¢ allow_methods: ['*']<br/>â€¢ Cross-origin support"]
            SERVER_CONFIG["âš™ï¸ Server Configuration<br/>â€¢ Host: 0.0.0.0<br/>â€¢ Port: 8000<br/>â€¢ Uvicorn ASGI server<br/>â€¢ Production ready"]
        end
        
        %% Model Loading & Management
        subgraph "ğŸ§  AI Model Management"
            MODEL_LOADING["ğŸ”„ Model Initialization<br/>â€¢ AutoModelForCausalLM.from_pretrained()<br/>â€¢ IFMF-Qwen2.5-1.5B-Instruct<br/>â€¢ device_map: cpu<br/>â€¢ torch_dtype: float32"]
            TOKENIZER_LOAD["ğŸ”¤ Tokenizer Loading<br/>â€¢ AutoTokenizer.from_pretrained()<br/>â€¢ Chat template support<br/>â€¢ Special token handling<br/>â€¢ Padding configuration"]
            MEMORY_MGMT["ğŸ’¾ Memory Management<br/>â€¢ low_cpu_mem_usage=True<br/>â€¢ Model parameter counting<br/>â€¢ Memory optimization<br/>â€¢ Resource monitoring"]
        end
        
        %% API Endpoints
        subgraph "ğŸ“¡ API Endpoint Implementation"
            GENERATE_EP["âœ¨ /generate Endpoint<br/>â€¢ POST method<br/>â€¢ Streaming response<br/>â€¢ JSON payload validation<br/>â€¢ Parameter clamping"]
            HEALTH_EP["ğŸ¥ /health Endpoint<br/>â€¢ Server status check<br/>â€¢ Model availability<br/>â€¢ Resource monitoring<br/>â€¢ Uptime tracking"]
            CANCEL_EP["âŒ /cancel Endpoint<br/>â€¢ Request cancellation<br/>â€¢ Generation stopping<br/>â€¢ Resource cleanup<br/>â€¢ Error handling"]
        end
        
        %% Text Generation Pipeline
        subgraph "ğŸ”® Text Generation Pipeline"
            REQUEST_PROC["ğŸ“ Request Processing<br/>â€¢ JSON payload parsing<br/>â€¢ Parameter validation<br/>â€¢ prompt, max_tokens, temperature<br/>â€¢ System message injection"]
            PROMPT_FORMAT["ğŸ“‹ Prompt Formatting<br/>â€¢ Indonesian Chef system prompt<br/>â€¢ Chat template application<br/>â€¢ Message structure<br/>â€¢ Context preparation"]
            GENERATION_ENGINE["âš¡ Generation Engine<br/>â€¢ model.generate()<br/>â€¢ Streaming in chunks<br/>â€¢ Token-by-token output<br/>â€¢ Temperature sampling"]
            STREAMING_RESP["ğŸ“Š Streaming Response<br/>â€¢ Server-Sent Events<br/>â€¢ Chunk processing<br/>â€¢ JSON formatting<br/>â€¢ Real-time delivery"]
        end
        
        %% Infrastructure & Deployment
        subgraph "ğŸ—ï¸ Infrastructure Management"
            COMPUTE_RESOURCES["ğŸ’» Compute Management<br/>â€¢ CPU allocation<br/>â€¢ Memory monitoring<br/>â€¢ Process optimization<br/>â€¢ Resource limits"]
            MODEL_FILES["ğŸ“ Model File Management<br/>â€¢ Model weights storage<br/>â€¢ Config file handling<br/>â€¢ Tokenizer assets<br/>â€¢ Version control"]
            ERROR_HANDLING["ğŸš¨ Error Handling<br/>â€¢ Exception catching<br/>â€¢ HTTP status codes<br/>â€¢ Error logging<br/>â€¢ Graceful degradation"]
            LOGGING["ğŸ“ Logging System<br/>â€¢ Request logging<br/>â€¢ Performance metrics<br/>â€¢ Error tracking<br/>â€¢ Debug information"]
        end
    end
    
    %% ========================================
    %% DETAILED CONNECTIONS & DATA FLOWS
    %% ========================================
    
    %% Training Pipeline to API Server
    MODEL_SAVING -.->|"Model Deployment"| MODEL_FILES
    METADATA_GEN -.->|"Configuration Transfer"| MODEL_LOADING
    CHECKPOINTS -.->|"Weight Files"| TOKENIZER_LOAD
    
    %% Web App to API Server (Detailed)
    API_CHAT -->|"HTTP POST /generate"| GENERATE_EP
    UTILS -->|"fetchEventSource()"| STREAMING_RESP
    STREAMING_RESP -->|"Server-Sent Events"| CHAT
    
    %% Internal Web App Flows
    HOME --> AUTH_PAGES
    AUTH_PAGES --> API_AUTH
    API_AUTH --> NEXTAUTH
    NEXTAUTH --> PRISMA_SCHEMA
    CHAT --> API_CHAT
    API_CHAT --> DB_OPERATIONS
    DB_OPERATIONS --> SQLITE
    CUSTOM --> SHADCN
    HOOKS --> UTILS
    MIDDLEWARE --> API_AUTH
    
    %% Internal Training Pipeline Flows
    RAW_DATA --> DATA_CLEANING
    DATA_CLEANING --> EXAMPLE_GEN
    EXAMPLE_GEN --> TOKENIZATION
    BASE_MODEL_CONFIG --> LORA_CONFIG
    LORA_CONFIG --> TRAINER_EXEC
    TRAINING_ARGS --> DATA_COLLATOR
    DATA_COLLATOR --> TRAINER_EXEC
    TOKENIZATION --> TRAINER_EXEC
    TRAINER_EXEC --> MONITORING
    MONITORING --> CHECKPOINTS
    CHECKPOINTS --> MODEL_SAVING
    MODEL_SAVING --> METADATA_GEN
    
    %% Internal API Server Flows
    FASTAPI_APP --> CORS_CONFIG
    CORS_CONFIG --> GENERATE_EP
    MODEL_LOADING --> GENERATION_ENGINE
    TOKENIZER_LOAD --> PROMPT_FORMAT
    GENERATE_EP --> REQUEST_PROC
    REQUEST_PROC --> PROMPT_FORMAT
    PROMPT_FORMAT --> GENERATION_ENGINE
    GENERATION_ENGINE --> STREAMING_RESP
    COMPUTE_RESOURCES --> MODEL_LOADING
    ERROR_HANDLING --> LOGGING
    
    %% Styling with More Detailed Colors
    classDef webAppFrontend fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000
    classDef webAppBackend fill:#e8eaf6,stroke:#3f51b5,stroke-width:2px,color:#000
    classDef trainingData fill:#e8f5e8,stroke:#388e3c,stroke-width:2px,color:#000
    classDef trainingModel fill:#f1f8e9,stroke:#689f38,stroke-width:2px,color:#000
    classDef apiServer fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#000
    classDef apiInference fill:#fdf4e3,stroke:#fb8c00,stroke-width:2px,color:#000
    classDef infrastructure fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000
    
    %% Apply detailed styles
    class HOME,CHAT,AUTH_PAGES,SHARED,ERRORS,SHADCN,CUSTOM,SIDEBAR webAppFrontend
    class NEXTAUTH,HOOKS,UTILS,THEME,API_AUTH,API_CHAT,MIDDLEWARE,VALIDATION webAppBackend
    class PRISMA_SCHEMA,DB_OPERATIONS,SQLITE,NEXTCONFIG,TAILWIND,PACKAGE webAppBackend
    
    class RAW_DATA,DATA_CLEANING,EXAMPLE_GEN,TOKENIZATION trainingData
    class BASE_MODEL_CONFIG,LORA_CONFIG,TRAINING_ARGS,SYSTEM_PROMPT,DATA_COLLATOR,TRAINER_EXEC,MONITORING trainingModel
    class CHECKPOINTS,MODEL_SAVING,METADATA_GEN,MODEL_VALIDATION trainingModel
    
    class FASTAPI_APP,CORS_CONFIG,SERVER_CONFIG,GENERATE_EP,HEALTH_EP,CANCEL_EP apiServer
    class MODEL_LOADING,TOKENIZER_LOAD,MEMORY_MGMT,REQUEST_PROC,PROMPT_FORMAT,GENERATION_ENGINE,STREAMING_RESP apiInference
    class COMPUTE_RESOURCES,MODEL_FILES,ERROR_HANDLING,LOGGING infrastructure